(()=>{var e={};e.id=314,e.ids=[314],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},11932:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o}),s(74618),s(12701),s(35866);var a=s(23191),r=s(88716),i=s(37922),l=s.n(i),n=s(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let o=["",{children:["consensus",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,74618)),"D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\consensus\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,12701)),"D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["D:\\编程\\KukeMC-Website\\KukeMC-WebSite\\src\\app\\consensus\\page.tsx"],x="/consensus/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/consensus/page",pathname:"/consensus",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},31804:(e,t,s)=>{Promise.resolve().then(s.bind(s,72326))},24230:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},48998:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},77506:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},85206:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(62881).Z)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},72326:(e,t,s)=>{"use strict";s.d(t,{default:()=>j});var a=s(10326),r=s(17577),i=s(24846),l=s(52952);let n=(0,s(62881).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var d=s(77506),o=s(97401),c=s(58080),x=s(32933),u=s(94019),p=s(48998),m=s(58038),h=s(85206),b=s(24230),g=s(41135),v=s(90434);let f=({proposal:e})=>{let t=e.stats.total,s=t>0?e.stats.agree/t*100:0,r=t>0?e.stats.disagree/t*100:0,l=!!e.end_time&&new Date(e.end_time)<new Date,n=!e.is_active||l,d=l&&e.stats.agree>e.stats.disagree;return(0,a.jsxs)(i.E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:(0,g.Z)("group relative flex flex-col overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 transition-all duration-300","border border-slate-200 dark:border-slate-800","hover:border-blue-500/30 dark:hover:border-blue-500/30 hover:shadow-xl hover:shadow-blue-500/5 dark:hover:shadow-blue-900/10","hover:-translate-y-1"),children:[l&&a.jsx("div",{className:"absolute -right-4 -top-4 opacity-10 dark:opacity-5 pointer-events-none select-none transform rotate-12",children:d?a.jsx(x.Z,{className:"w-32 h-32 text-green-500"}):a.jsx(u.Z,{className:"w-32 h-32 text-red-500"})}),(0,a.jsxs)("div",{className:"mb-4 relative z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("span",{className:(0,g.Z)("inline-flex items-center rounded-md px-2.5 py-0.5 text-xs font-bold ring-1 ring-inset",n?"bg-slate-100 text-slate-600 ring-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:ring-slate-700":"bg-green-50 text-green-700 ring-green-600/20 dark:bg-green-900/20 dark:text-green-400 dark:ring-green-900/30"),children:n?l?"已结束":"已关闭":"进行中"}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-slate-400 font-medium",children:[a.jsx(p.Z,{className:"h-3.5 w-3.5"}),a.jsx("span",{children:(0,o.Q)(new Date(e.created_at),{addSuffix:!0,locale:c.U})})]})]}),a.jsx(v.default,{href:`/consensus/${e.id}`,className:"block group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:a.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-2 line-clamp-2 leading-tight",children:e.title})}),e.min_level>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs font-medium text-amber-600 dark:text-amber-500 bg-amber-50 dark:bg-amber-900/20 px-2 py-1 rounded w-fit mt-2 border border-amber-100 dark:border-amber-900/30",children:[a.jsx(m.Z,{className:"h-3.5 w-3.5"}),(0,a.jsxs)("span",{children:["Lv.",e.min_level," 以上可参与"]})]})]}),a.jsx("div",{className:"mb-6 text-sm text-slate-500 dark:text-slate-400 line-clamp-2 leading-relaxed flex-grow",children:e.content}),(0,a.jsxs)("div",{className:"mt-auto space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400",children:[(0,a.jsxs)("span",{children:["支持 ",s.toFixed(0),"%"]}),(0,a.jsxs)("span",{children:["反对 ",r.toFixed(0),"%"]})]}),(0,a.jsxs)("div",{className:"h-2.5 w-full overflow-hidden rounded-full bg-slate-100 dark:bg-slate-800 flex relative",children:[a.jsx(i.E.div,{initial:{width:0},animate:{width:`${s}%`},transition:{duration:1,ease:"easeOut"},className:"h-full bg-green-500 rounded-full"}),a.jsx("div",{className:"flex-1"})," ",a.jsx(i.E.div,{initial:{width:0},animate:{width:`${r}%`},transition:{duration:1,ease:"easeOut",delay:.1},className:"h-full bg-red-500 rounded-full"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100 dark:border-slate-800",children:[(0,a.jsxs)("div",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:[t," 人已参与"]}),e.my_vote?(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("span",{className:(0,g.Z)("text-xs font-bold px-2 py-1 rounded border uppercase","agree"===e.my_vote.vote_type?"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-900/30":"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-900/30"),children:["已","agree"===e.my_vote.vote_type?"支持":"反对"]}),!n&&a.jsx(v.default,{href:`/consensus/${e.id}`,className:"text-slate-400 hover:text-blue-500 transition-colors",children:a.jsx(h.Z,{className:"w-4 h-4"})})]}):n?a.jsx("span",{className:"text-xs font-medium text-slate-400",children:"投票已截止"}):(0,a.jsxs)(v.default,{href:`/consensus/${e.id}`,className:"flex items-center gap-1 text-sm font-bold text-blue-600 dark:text-blue-400 hover:gap-2 transition-all",children:["参与投票 ",a.jsx(b.Z,{className:"w-4 h-4"})]})]})]})]})};var y=s(99348);let j=()=>{let[e,t]=(0,r.useState)([]),[s,o]=(0,r.useState)(!0),[c,x]=(0,r.useState)(!1),u=async()=>{o(!0);try{let e=await (0,y.Bp)(c);t(e)}catch(e){console.error("Failed to fetch proposals",e)}finally{o(!1)}};return(0,r.useEffect)(()=>{u()},[c]),a.jsx("div",{className:"min-h-screen pb-20 pt-24",children:(0,a.jsxs)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-12 text-center",children:[a.jsx(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-4 flex justify-center",children:a.jsx("div",{className:"rounded-full bg-blue-100 p-3 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400",children:a.jsx(l.Z,{className:"h-8 w-8"})})}),a.jsx(i.E.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-3xl font-bold tracking-tight text-slate-900 dark:text-white sm:text-4xl",children:"玩家众议中心"}),a.jsx(i.E.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mx-auto mt-4 max-w-2xl text-lg text-slate-600 dark:text-slate-400",children:"您的声音很重要。参与服务器发展决策，投票表达您的观点，让我们共同塑造 KukeMC 的未来。"})]}),a.jsx("div",{className:"mb-8 flex justify-end",children:(0,a.jsxs)("button",{onClick:()=>x(!c),className:`flex items-center gap-2 rounded-lg px-4 py-2 text-sm font-medium transition-colors ${c?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-white text-slate-600 hover:bg-slate-50 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700"}`,children:[a.jsx(n,{className:"h-4 w-4"}),c?"只显示进行中":"显示全部"]})}),s?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsx(d.Z,{className:"h-8 w-8 animate-spin text-blue-500"})}):a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3",children:e.length>0?e.map(e=>a.jsx(f,{proposal:e,onVoteSuccess:u},e.id)):a.jsx("div",{className:"col-span-full py-12 text-center text-slate-500 dark:text-slate-400",children:a.jsx("p",{children:"暂无相关提案"})})})]})})}},99348:(e,t,s)=>{"use strict";s.d(t,{Bp:()=>r,JT:()=>n,QB:()=>l,Z_:()=>d,pU:()=>i});var a=s(33385);let r=async(e=!1)=>(await a.ZP.get("/api/consensus/proposals",{params:{active_only:e}})).data,i=async e=>(await a.ZP.get(`/api/consensus/proposals/${e}`)).data,l=async e=>(await a.ZP.post("/api/consensus/vote",e)).data,n=async e=>(await a.ZP.post(`/api/consensus/votes/${e}/like`)).data,d=async(e,t)=>(await a.ZP.post(`/api/consensus/votes/${e}/reply`,{content:t})).data},74618:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>l});var a=s(19510),r=s(71159);let i=(0,s(68570).createProxy)(String.raw`D:\编程\KukeMC-Website\KukeMC-WebSite\src\components\next\ConsensusClient.tsx#default`),l={title:"玩家众议 - KukeMC",description:"参与 KukeMC 服务器的决策，为您支持的提案投票，共同建设更好的社区。"};function n(){return a.jsx(r.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-500"})}),children:a.jsx(i,{})})}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[856,503,609,136],()=>s(11932));module.exports=a})();